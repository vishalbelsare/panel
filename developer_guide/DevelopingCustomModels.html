
<!DOCTYPE html>

<html>
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>DevelopingCustomModels — Panel 0.12.0 documentation</title>
<link href="../_static/css/theme.css" rel="stylesheet"/>
<link href="../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet"/>
<link href="../_static/vendor/fontawesome/5.13.0/css/all.min.css" rel="stylesheet"/>
<link as="font" crossorigin="" href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2" rel="preload" type="font/woff2"/>
<link href="../_static/pygments.css" rel="stylesheet" type="text/css">
<link href="../_static/basic.css" rel="stylesheet" type="text/css">
<link href="../_static/togglebutton.css" rel="stylesheet" type="text/css">
<link href="../_static/mystnb.css" rel="stylesheet" type="text/css"/>
<link href="../_static/graphviz.css" rel="stylesheet" type="text/css"/>
<link href="../_static/nbsite.css" rel="stylesheet" type="text/css"/>
<link href="../_static/css/custom.css" rel="stylesheet" type="text/css"/>
<link as="script" href="../_static/js/index.1c5a1a01449ed65a7b51.js" rel="preload"/>
<script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
<script src="../_static/jquery.js"></script>
<script src="../_static/underscore.js"></script>
<script src="../_static/doctools.js"></script>
<script src="../_static/togglebutton.js"></script>
<script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
<link href="../_static/favicon.ico" rel="shortcut icon">
<link href="../genindex.html" rel="index" title="Index"/>
<link href="../search.html" rel="search" title="Search"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<meta content="en" name="docsearch:language"/>
</link></link></link></link></head>
<body data-offset="80" data-spy="scroll" data-target="#bd-toc-nav">
<div class="container-fluid" id="banner"></div>
<nav class="navbar navbar-dark navbar-expand-lg bg-dark fixed-top bd-navbar" id="navbar-main"><div class="container-xl">
<div id="navbar-start">
<a class="navbar-brand" href="../index.html">
<img alt="logo" class="logo" src="../_static/logo_horizontal.png"/>
</a>
</div>
<button aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation" class="navbar-toggler" data-target="#navbar-collapsible" data-toggle="collapse" type="button">
<span class="navbar-toggler-icon"></span>
</button>
<div class="col-lg-9 collapse navbar-collapse" id="navbar-collapsible">
<div class="mr-auto" id="navbar-center">
<div class="navbar-center-item">
<ul class="navbar-nav" id="navbar-main-elements">
<li class="toctree-l1 nav-item">
<a class="reference internal nav-link" href="../getting_started/index.html">
  Getting Started
 </a>
</li>
<li class="toctree-l1 nav-item">
<a class="reference internal nav-link" href="../user_guide/index.html">
  User Guide
 </a>
</li>
<li class="toctree-l1 nav-item">
<a class="reference internal nav-link" href="../gallery/index.html">
  Gallery
 </a>
</li>
<li class="toctree-l1 nav-item">
<a class="reference internal nav-link" href="../reference/index.html">
  Reference Gallery
 </a>
</li>
<li class="toctree-l1 nav-item">
<a class="reference internal nav-link" href="index.html">
  Developers
 </a>
</li>
<li class="toctree-l1 nav-item">
<a class="reference internal nav-link" href="../api/index.html">
  API
 </a>
</li>
<li class="toctree-l1 nav-item">
<a class="reference internal nav-link" href="../releases.html">
  Releases
 </a>
</li>
<li class="toctree-l1 nav-item">
<a class="reference internal nav-link" href="../FAQ.html">
  FAQ
 </a>
</li>
<li class="toctree-l1 nav-item">
<a class="reference internal nav-link" href="../about/index.html">
  About
 </a>
</li>
</ul>
</div>
</div>
<div id="navbar-end">
<div class="navbar-end-item">
<ul aria-label="Icon Links" class="navbar-nav" id="navbar-icon-links">
<li class="nav-item">
<a class="nav-link" href="https://github.com/holoviz/panel" rel="noopener" target="_blank" title="GitHub">
<span><i class="fab fa-github-square"></i></span>
<label class="sr-only">GitHub</label>
</a>
</li>
<li class="nav-item">
<a class="nav-link" href="https://twitter.com/Panel_Org" rel="noopener" target="_blank" title="Twitter">
<span><i class="fab fa-twitter-square"></i></span>
<label class="sr-only">Twitter</label>
</a>
</li>
<li class="nav-item">
<a class="nav-link" href="https://discourse.holoviz.org/" rel="noopener" target="_blank" title="Discourse">
<span><i class="fab fa-discourse"></i></span>
<label class="sr-only">Discourse</label>
</a>
</li>
</ul>
</div>
</div>
</div>
</div>
</nav>
<div class="container-xl">
<div class="row">
<!-- Only show if we have sidebars configured, else just a small margin  -->
<div class="col-12 col-md-2 bd-sidebar"><form action="../search.html" class="bd-search d-flex align-items-center" method="get">
<i class="icon fas fa-search"></i>
<input aria-label="Search the docs ..." autocomplete="off" class="form-control" id="search-input" name="q" placeholder="Search the docs ..." type="search"/>
</form><nav aria-label="Main navigation" class="bd-links" id="bd-docs-nav">
<div class="bd-toc-item active">
</div>
</nav>
</div>
<div class="d-none d-xl-block col-xl-2 bd-toc">
<div class="toc-item">
<div class="tocsection onthispage pt-5 pb-3">
<i class="fas fa-list"></i> On this page
</div>
<nav id="bd-toc-nav">
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#developing-custom-models">
   Developing Custom Models
  </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#adding-a-new-custom-model">
     Adding a new Custom Model
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#add-the-panel-python-model">
       Add the Panel Python Model
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#add-the-bokeh-python-model">
       Add the Bokeh Python Model
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#add-the-bokeh-typescript-model">
       Add the Bokeh TypeScript Model
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#build-the-model">
       Build the Model
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#test-the-model">
       Test the Model
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#save-your-new-model">
       Save your new Model
      </a>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#build-a-small-html-example">
     Build a small HTML Example
    </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#using-the-javascript-model">
     Using the Javascript Model
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#import-the-javascript-library">
       Import the Javascript Library
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#render-the-plot">
       Render the Plot
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#build-and-test">
       Build and Test
      </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#save-your-model">
       Save Your Model
      </a>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#next-steps">
     Next Steps
    </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#check-list">
     Check List
    </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#tips-and-tricks">
     Tips and Tricks
    </a>
</li>
</ul>
</li>
</ul>
</nav>
</div>
<div class="toc-item">
</div>
</div>
<main class="col-12 col-md-10 col-xl-8 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
<div>
<div class="section" id="developingcustommodels">
<h1>DevelopingCustomModels<a class="headerlink" href="#developingcustommodels" title="Permalink to this headline">¶</a></h1>
<div class="section" id="developing-custom-models">
<h2>Developing Custom Models<a class="headerlink" href="#developing-custom-models" title="Permalink to this headline">¶</a></h2>
<p>Panel ships with a number of custom Bokeh models, which have both Python and Javascript components. When developing Panel these custom models have to be compiled. This happens automatically with <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">-e</span> <span class="pre">.</span></code> or <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">setup.py</span> <span class="pre">develop</span></code>, however when runnning actively developing you can rebuild the extension with <code class="docutils literal notranslate"><span class="pre">panel</span> <span class="pre">build</span> <span class="pre">panel</span></code>. The build command is just an alias for <code class="docutils literal notranslate"><span class="pre">bokeh</span> <span class="pre">build</span></code>; see the <a class="reference external" href="https://docs.bokeh.org/en/latest/docs/dev_guide/setup.html">Bokeh developer guide</a> for more information about developing bokeh models or the <a class="reference external" href="https://awesome-panel.readthedocs.io/en/latest/guides/awesome-panel-extensions-guide/bokeh-extensions.html">Awesome Panel - Bokeh Extensions Guide</a></p>
<p>Just like any other Javascript (or Typescript) library Panel defines a <code class="docutils literal notranslate"><span class="pre">package.json</span></code> and <code class="docutils literal notranslate"><span class="pre">package-lock.json</span></code> files. When adding, updating or removing a dependency in the <code class="docutils literal notranslate"><span class="pre">package.json</span></code> file ensure you commit the changes to the <code class="docutils literal notranslate"><span class="pre">package-lock.json</span></code> after running npm install.</p>
<div class="section" id="adding-a-new-custom-model">
<h3>Adding a new Custom Model<a class="headerlink" href="#adding-a-new-custom-model" title="Permalink to this headline">¶</a></h3>
<p>This example will guide you through adding a new model.</p>
<p>We will use the the <code class="docutils literal notranslate"><span class="pre">ChartJS</span></code> model as an example. But you should replace <code class="docutils literal notranslate"><span class="pre">ChartJS</span></code> and similar with the name of your model.</p>
<p>Here we will add a simple Button model to start with. But we call it <code class="docutils literal notranslate"><span class="pre">ChartJS</span></code>.</p>
<p>My experience is that you should start small with a working example and the continue in small, incremental steps. For me it did not work trying to copy a large, complex example and refactoring it when I started out learning about Custom Models.</p>
<ol class="simple">
<li><p>Create a new branch <code class="docutils literal notranslate"><span class="pre">chartjs</span></code>.</p></li>
<li><p>Add the files and code for a <em>minimum working model</em>. This includes</p>
<ul class="simple">
<li><p>A Panel Python model</p></li>
<li><p>A Bokeh Python and TypeScript model</p></li>
</ul>
</li>
</ol>
<div class="section" id="add-the-panel-python-model">
<h4>Add the Panel Python Model<a class="headerlink" href="#add-the-panel-python-model" title="Permalink to this headline">¶</a></h4>
<p>Add the file <em>panel/pane/chartjs.py</em> and the code</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">param</span>

<span class="kn">from</span> <span class="nn">panel.widgets.base</span> <span class="kn">import</span> <span class="n">Widget</span>

<span class="kn">from</span> <span class="nn">..models</span> <span class="kn">import</span> <span class="n">ChartJS</span> <span class="k">as</span> <span class="n">_BkChartJS</span>


<span class="k">class</span> <span class="nc">ChartJS</span><span class="p">(</span><span class="n">Widget</span><span class="p">):</span>
    <span class="c1"># Set the Bokeh model to use</span>
    <span class="n">_widget_type</span> <span class="o">=</span> <span class="n">_BkChartJS</span>

    <span class="c1"># Rename Panel Parameters -&gt; Bokeh Model properties</span>
    <span class="c1"># Parameters like title that does not exist on the Bokeh model should be renamed to None</span>
    <span class="n">_rename</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">"title"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="c1"># Parameters to be mapped to Bokeh model properties</span>
    <span class="nb">object</span> <span class="o">=</span> <span class="n">param</span><span class="o">.</span><span class="n">String</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="s2">"Click Me!"</span><span class="p">)</span>
    <span class="n">clicks</span> <span class="o">=</span> <span class="n">param</span><span class="o">.</span><span class="n">Integer</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>Add the Panel model to <code class="docutils literal notranslate"><span class="pre">panel/pane/__init__.py</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">.chartjs</span> <span class="kn">import</span> <span class="n">ChartJS</span>
</pre></div>
</div>
</div>
<div class="section" id="add-the-bokeh-python-model">
<h4>Add the Bokeh Python Model<a class="headerlink" href="#add-the-bokeh-python-model" title="Permalink to this headline">¶</a></h4>
<p>Add the file <em>panel/models/chartjs.py</em> and the code</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">bokeh.core.properties</span> <span class="kn">import</span> <span class="n">Int</span><span class="p">,</span> <span class="n">String</span>
<span class="kn">from</span> <span class="nn">bokeh.models</span> <span class="kn">import</span> <span class="n">HTMLBox</span>

<span class="k">class</span> <span class="nc">ChartJS</span><span class="p">(</span><span class="n">HTMLBox</span><span class="p">):</span>
    <span class="sd">"""Custom ChartJS Model"""</span>

    <span class="nb">object</span> <span class="o">=</span> <span class="n">String</span><span class="p">()</span>
    <span class="n">clicks</span> <span class="o">=</span> <span class="n">Int</span><span class="p">()</span>
</pre></div>
</div>
<p>Add the Bokeh model to <code class="docutils literal notranslate"><span class="pre">panel/models/__init__.py</span></code> file</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">.chartjs</span> <span class="kn">import</span> <span class="n">ChartJS</span>
</pre></div>
</div>
</div>
<div class="section" id="add-the-bokeh-typescript-model">
<h4>Add the Bokeh TypeScript Model<a class="headerlink" href="#add-the-bokeh-typescript-model" title="Permalink to this headline">¶</a></h4>
<p>Add the file <em>panel/models/chartjs.ts</em> and the code</p>
<div class="highlight-typescript notranslate"><div class="highlight"><pre><span></span><span class="c1">// See https://docs.bokeh.org/en/latest/docs/reference/models/layouts.html</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">HTMLBox</span><span class="p">,</span> <span class="nx">HTMLBoxView</span> <span class="p">}</span> <span class="k">from</span> <span class="s2">"@bokehjs/models/layouts/html_box"</span>

<span class="c1">// See https://docs.bokeh.org/en/latest/docs/reference/core/properties.html</span>
<span class="k">import</span> <span class="o">*</span> <span class="kr">as</span> <span class="nx">p</span> <span class="k">from</span> <span class="s2">"@bokehjs/core/properties"</span>

<span class="c1">// The view of the Bokeh extension/ HTML element</span>
<span class="c1">// Here you can define how to render the model as well as react to model changes or View events.</span>
<span class="k">export</span> <span class="kd">class</span> <span class="nx">ChartJSView</span> <span class="k">extends</span> <span class="nx">HTMLBoxView</span> <span class="p">{</span>
    <span class="nx">model</span>: <span class="kt">ChartJS</span>
    <span class="nx">objectElement</span>: <span class="kt">any</span> <span class="c1">// Element</span>

    <span class="nx">connect_signals</span><span class="p">()</span><span class="o">:</span> <span class="k">void</span> <span class="p">{</span>
        <span class="k">super</span><span class="p">.</span><span class="nx">connect_signals</span><span class="p">()</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">model</span><span class="p">.</span><span class="nx">properties</span><span class="p">.</span><span class="nx">object</span><span class="p">.</span><span class="nx">change</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">render</span><span class="p">();</span>
        <span class="p">})</span>
    <span class="p">}</span>

    <span class="nx">render</span><span class="p">()</span><span class="o">:</span> <span class="k">void</span> <span class="p">{</span>
        <span class="k">super</span><span class="p">.</span><span class="nx">render</span><span class="p">()</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">el</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="sb">`&lt;button type="button"&gt;</span><span class="si">${</span><span class="k">this</span><span class="p">.</span><span class="nx">model</span><span class="p">.</span><span class="nx">object</span><span class="si">}</span><span class="sb">&lt;/button&gt;`</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">objectElement</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">el</span><span class="p">.</span><span class="nx">firstElementChild</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">objectElement</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">"click"</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">model</span><span class="p">.</span><span class="nx">clicks</span><span class="o">+=</span><span class="mf">1</span><span class="p">;},</span> <span class="kc">false</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">export</span> <span class="nx">namespace</span> <span class="nx">ChartJS</span> <span class="p">{</span>
    <span class="k">export</span> <span class="kd">type</span> <span class="nx">Attrs</span> <span class="o">=</span> <span class="nx">p</span><span class="p">.</span><span class="nx">AttrsOf</span><span class="o">&lt;</span><span class="nx">Props</span><span class="o">&gt;</span>
    <span class="k">export</span> <span class="kd">type</span> <span class="nx">Props</span> <span class="o">=</span> <span class="nx">HTMLBox</span><span class="p">.</span><span class="nx">Props</span> <span class="o">&amp;</span> <span class="p">{</span>
        <span class="nx">object</span>: <span class="kt">p.Property</span><span class="o">&lt;</span><span class="kt">string</span><span class="o">&gt;</span><span class="p">,</span>
        <span class="nx">clicks</span>: <span class="kt">p.Property</span><span class="o">&lt;</span><span class="kt">number</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">export</span> <span class="kd">interface</span> <span class="nx">ChartJS</span> <span class="k">extends</span> <span class="nx">ChartJS</span><span class="p">.</span><span class="nx">Attrs</span> <span class="p">{</span> <span class="p">}</span>

<span class="c1">// The Bokeh .ts model corresponding to the Bokeh .py model</span>
<span class="k">export</span> <span class="kd">class</span> <span class="nx">ChartJS</span> <span class="k">extends</span> <span class="nx">HTMLBox</span> <span class="p">{</span>
    <span class="nx">properties</span>: <span class="kt">ChartJS.Props</span>

    <span class="kr">constructor</span><span class="p">(</span><span class="nx">attrs?</span>: <span class="kt">Partial</span><span class="o">&lt;</span><span class="nx">ChartJS</span><span class="p">.</span><span class="nx">Attrs</span><span class="o">&gt;</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">super</span><span class="p">(</span><span class="nx">attrs</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="k">static</span> <span class="nx">__module__</span> <span class="o">=</span> <span class="s2">"panel.models.chartjs"</span>

    <span class="k">static</span> <span class="nx">init_ChartJS</span><span class="p">()</span><span class="o">:</span> <span class="k">void</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">default_view</span> <span class="o">=</span> <span class="nx">ChartJSView</span><span class="p">;</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">define</span><span class="o">&lt;</span><span class="nx">ChartJS</span><span class="p">.</span><span class="nx">Props</span><span class="o">&gt;</span><span class="p">(({</span><span class="nx">Int</span><span class="p">,</span> <span class="nb">String</span><span class="p">})</span> <span class="o">=&gt;</span> <span class="p">({</span>
            <span class="nx">object</span><span class="o">:</span> <span class="p">[</span><span class="nb">String</span><span class="p">,</span> <span class="s2">"Click Me!"</span><span class="p">],</span>
            <span class="nx">clicks</span><span class="o">:</span> <span class="p">[</span><span class="nx">Int</span><span class="p">,</span> <span class="mf">0</span><span class="p">],</span>
        <span class="p">}))</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Add the <code class="docutils literal notranslate"><span class="pre">ChartJS</span></code> typescript model to <em>panel/models/index.ts</em></p>
<div class="highlight-typescript notranslate"><div class="highlight"><pre><span></span><span class="k">export</span> <span class="p">{</span><span class="nx">ChartJS</span><span class="p">}</span> <span class="k">from</span> <span class="s2">"./chartjs"</span>
</pre></div>
</div>
</div>
<div class="section" id="build-the-model">
<h4>Build the Model<a class="headerlink" href="#build-the-model" title="Permalink to this headline">¶</a></h4>
<p>You can now build the model using <code class="docutils literal notranslate"><span class="pre">panel</span> <span class="pre">build</span> <span class="pre">panel</span></code>. It should look similar to</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">(</span>base<span class="o">)</span> root@475bb36209a9:/workspaces/panel# panel build panel
Working directory: /workspaces/panel/panel
Using /workspaces/panel/panel/tsconfig.json
Compiling styles
Compiling TypeScript <span class="o">(</span><span class="m">45</span> files<span class="o">)</span>
Linking modules
Output written to /workspaces/panel/panel/dist
All <span class="k">done</span>.
</pre></div>
</div>
</div>
<div class="section" id="test-the-model">
<h4>Test the Model<a class="headerlink" href="#test-the-model" title="Permalink to this headline">¶</a></h4>
<p>Add the file <em>panel/tests/pane/test_chartjs.py</em> and the code</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">panel</span> <span class="k">as</span> <span class="nn">pn</span>


<span class="k">def</span> <span class="nf">test_constructor</span><span class="p">():</span>
    <span class="n">chartjs</span> <span class="o">=</span> <span class="n">pn</span><span class="o">.</span><span class="n">pane</span><span class="o">.</span><span class="n">ChartJS</span><span class="p">(</span><span class="nb">object</span><span class="o">=</span><span class="s2">"Click Me Now!"</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">get_app</span><span class="p">():</span>
    <span class="n">chartjs</span> <span class="o">=</span> <span class="n">pn</span><span class="o">.</span><span class="n">pane</span><span class="o">.</span><span class="n">ChartJS</span><span class="p">(</span><span class="nb">object</span><span class="o">=</span><span class="s2">"Click Me Now!"</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">pn</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span>
        <span class="n">chartjs</span><span class="p">,</span> <span class="n">pn</span><span class="o">.</span><span class="n">Param</span><span class="p">(</span><span class="n">chartjs</span><span class="p">,</span> <span class="n">parameters</span><span class="o">=</span><span class="p">[</span><span class="s2">"object"</span><span class="p">,</span> <span class="s2">"clicks"</span><span class="p">])</span>
    <span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">"bokeh"</span><span class="p">):</span>
    <span class="n">get_app</span><span class="p">()</span><span class="o">.</span><span class="n">servable</span><span class="p">()</span>
</pre></div>
</div>
<p>Run <code class="docutils literal notranslate"><span class="pre">pytest</span> <span class="pre">panel/tests/pane/test_chartjs.py</span></code> and make sure it passes.</p>
<p>Serve the app with <code class="docutils literal notranslate"><span class="pre">panel</span> <span class="pre">serve</span> <span class="pre">panel/tests/pane/test_chartjs.py</span> <span class="pre">--auto</span> <span class="pre">--show</span></code></p>
<p>You have to <em>hard refresh</em> your browser to reload the new panel <code class="docutils literal notranslate"><span class="pre">.js</span></code> files with your <code class="docutils literal notranslate"><span class="pre">ChartJS</span></code> model. In Chrome I press <code class="docutils literal notranslate"><span class="pre">CTRL+F5</span></code>. See <a class="reference external" href="https://www.namecheap.com/support/knowledgebase/article.aspx/10078/2194/how-to-do-a-hard-refresh-in-chrome-firefox-and-ie/">How to hard refresh in Chrome, Firefox and IE</a> for other browsers.</p>
<p>Now you can manually test your model</p>
<p><img alt="Chart JS Button" src="../assets/chartjs-button.gif"/></p>
</div>
<div class="section" id="save-your-new-model">
<h4>Save your new Model<a class="headerlink" href="#save-your-new-model" title="Permalink to this headline">¶</a></h4>
<p>Finally you should save your changes via <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">add</span> <span class="pre">.</span></code> and maybe even commit them <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">commit</span> <span class="pre">-m</span> <span class="pre">"First</span> <span class="pre">iteration</span> <span class="pre">on</span> <span class="pre">ChartJS</span> <span class="pre">model"</span></code></p>
</div>
</div>
<div class="section" id="build-a-small-html-example">
<h3>Build a small HTML Example<a class="headerlink" href="#build-a-small-html-example" title="Permalink to this headline">¶</a></h3>
<p>In the beginning of your journey into Custom Models there will be things that break and difficulties figuring out why. When you combine several new things it can be really difficult to figure out why. Is the problem Panel, Bokeh, Python, Javascript, Node or ….?</p>
<p>So I suggest creating a small, working example in plain HTML/ JS before you start combining with Panel and Bokeh Models.</p>
<p>Please note the below example works out of the box. It is not always that easy importing javascript libraries in a Notebook. So it can be a good idea to work in a <code class="docutils literal notranslate"><span class="pre">.html</span></code> file first.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%HTML</span>
<span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">"https://cdn.jsdelivr.net/npm/chart.js@2.8.0"</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"chart-container"</span> <span class="na">style</span><span class="o">=</span><span class="s">"position: relative; height:400px; width:100%"</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">canvas</span> <span class="na">id</span><span class="o">=</span><span class="s">"myChart"</span><span class="p">&gt;&lt;/</span><span class="nt">canvas</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="kd">var</span> <span class="nx">ctx</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">'myChart'</span><span class="p">).</span><span class="nx">getContext</span><span class="p">(</span><span class="s1">'2d'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">chart</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Chart</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span> <span class="p">{</span>
    <span class="c1">// The type of chart we want to create</span>
    <span class="nx">type</span><span class="o">:</span> <span class="s1">'line'</span><span class="p">,</span>

    <span class="c1">// The data for our dataset</span>
    <span class="nx">data</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">labels</span><span class="o">:</span> <span class="p">[</span><span class="s1">'January'</span><span class="p">,</span> <span class="s1">'February'</span><span class="p">,</span> <span class="s1">'March'</span><span class="p">,</span> <span class="s1">'April'</span><span class="p">,</span> <span class="s1">'May'</span><span class="p">,</span> <span class="s1">'June'</span><span class="p">,</span> <span class="s1">'July'</span><span class="p">],</span>
        <span class="nx">datasets</span><span class="o">:</span> <span class="p">[{</span>
            <span class="nx">label</span><span class="o">:</span> <span class="s1">'My First dataset'</span><span class="p">,</span>
            <span class="nx">backgroundColor</span><span class="o">:</span> <span class="s1">'rgb(255, 99, 132)'</span><span class="p">,</span>
            <span class="nx">borderColor</span><span class="o">:</span> <span class="s1">'rgb(255, 99, 132)'</span><span class="p">,</span>
            <span class="nx">data</span><span class="o">:</span> <span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="mf">10</span><span class="p">,</span> <span class="mf">5</span><span class="p">,</span> <span class="mf">2</span><span class="p">,</span> <span class="mf">20</span><span class="p">,</span> <span class="mf">30</span><span class="p">,</span> <span class="mf">45</span><span class="p">]</span>
        <span class="p">}]</span>
    <span class="p">},</span>

    <span class="c1">// Configuration options go here</span>
    <span class="nx">options</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">responsive</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="nx">maintainAspectRatio</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">});</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>
<div class="chart-container" style="position: relative; height:400px; width:100%">
<canvas id="myChart"></canvas>
</div>
<script>
var ctx = document.getElementById('myChart').getContext('2d');
var chart = new Chart(ctx, {
    // The type of chart we want to create
    type: 'line',

    // The data for our dataset
    data: {
        labels: ['January', 'February', 'March', 'April', 'May', 'June', 'July'],
        datasets: [{
            label: 'My First dataset',
            backgroundColor: 'rgb(255, 99, 132)',
            borderColor: 'rgb(255, 99, 132)',
            data: [0, 10, 5, 2, 20, 30, 45]
        }]
    },

    // Configuration options go here
    options: {
        responsive: true,
        maintainAspectRatio: false,
    }
});
</script>
</div></div>
</div>
</div>
<div class="section" id="using-the-javascript-model">
<h3>Using the Javascript Model<a class="headerlink" href="#using-the-javascript-model" title="Permalink to this headline">¶</a></h3>
<p>Getting something shown using the <code class="docutils literal notranslate"><span class="pre">ChartJS</span></code> <code class="docutils literal notranslate"><span class="pre">js</span></code> library would be the next step. It might require a bit of experimentation, looking at other examples, google or support from the community.</p>
<p>Here I found that a good step where the following changes</p>
<div class="section" id="import-the-javascript-library">
<h4>Import the Javascript Library<a class="headerlink" href="#import-the-javascript-library" title="Permalink to this headline">¶</a></h4>
<p>Update <em>test_chartjs.py</em> tp</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">panel</span> <span class="k">as</span> <span class="nn">pn</span>


<span class="k">def</span> <span class="nf">test_constructor</span><span class="p">():</span>
    <span class="n">chartjs</span> <span class="o">=</span> <span class="n">pn</span><span class="o">.</span><span class="n">pane</span><span class="o">.</span><span class="n">ChartJS</span><span class="p">(</span><span class="nb">object</span><span class="o">=</span><span class="s2">"Click Me Now!"</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">get_app</span><span class="p">():</span>
    <span class="n">chartjs</span> <span class="o">=</span> <span class="n">pn</span><span class="o">.</span><span class="n">pane</span><span class="o">.</span><span class="n">ChartJS</span><span class="p">(</span><span class="nb">object</span><span class="o">=</span><span class="s2">"Click Me Now!"</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">pn</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span>
        <span class="n">chartjs</span><span class="p">,</span> <span class="n">pn</span><span class="o">.</span><span class="n">Param</span><span class="p">(</span><span class="n">chartjs</span><span class="p">,</span> <span class="n">parameters</span><span class="o">=</span><span class="p">[</span><span class="s2">"object"</span><span class="p">,</span> <span class="s2">"clicks"</span><span class="p">])</span>
    <span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">"bokeh"</span><span class="p">):</span>
    <span class="n">pn</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">js_files</span><span class="p">[</span><span class="s2">"chartjs"</span><span class="p">]</span><span class="o">=</span><span class="s2">"https://cdn.jsdelivr.net/npm/chart.js@2.8.0"</span>
    <span class="n">get_app</span><span class="p">()</span><span class="o">.</span><span class="n">servable</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="render-the-plot">
<h4>Render the Plot<a class="headerlink" href="#render-the-plot" title="Permalink to this headline">¶</a></h4>
<p>In the <em>chartjs.ts</em> file add <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">{</span> <span class="pre">canvas,</span> <span class="pre">div</span> <span class="pre">}</span> <span class="pre">from</span> <span class="pre">"@bokehjs/core/dom";</span></code> at the top and change the <code class="docutils literal notranslate"><span class="pre">render</span></code> function to</p>
<div class="highlight-typescript notranslate"><div class="highlight"><pre><span></span><span class="nx">render</span><span class="p">()</span><span class="o">:</span> <span class="k">void</span> <span class="p">{</span>
    <span class="k">super</span><span class="p">.</span><span class="nx">render</span><span class="p">()</span>
    <span class="kd">var</span> <span class="nx">object</span> <span class="o">=</span> <span class="p">{</span>
        <span class="kd">type</span><span class="o">:</span> <span class="s1">'line'</span><span class="p">,</span>
        <span class="nx">data</span><span class="o">:</span> <span class="p">{</span>
            <span class="nx">labels</span><span class="o">:</span> <span class="p">[</span><span class="s1">'January'</span><span class="p">,</span> <span class="s1">'February'</span><span class="p">,</span> <span class="s1">'March'</span><span class="p">,</span> <span class="s1">'April'</span><span class="p">,</span> <span class="s1">'May'</span><span class="p">,</span> <span class="s1">'June'</span><span class="p">,</span> <span class="s1">'July'</span><span class="p">],</span>
            <span class="nx">datasets</span><span class="o">:</span> <span class="p">[{</span>
                <span class="nx">label</span><span class="o">:</span> <span class="s1">'My First dataset'</span><span class="p">,</span>
                <span class="nx">backgroundColor</span><span class="o">:</span> <span class="s1">'rgb(255, 99, 132)'</span><span class="p">,</span>
                <span class="nx">borderColor</span><span class="o">:</span> <span class="s1">'rgb(255, 99, 132)'</span><span class="p">,</span>
                <span class="nx">data</span><span class="o">:</span> <span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="mf">10</span><span class="p">,</span> <span class="mf">5</span><span class="p">,</span> <span class="mf">2</span><span class="p">,</span> <span class="mf">20</span><span class="p">,</span> <span class="mf">30</span><span class="p">,</span> <span class="mf">45</span><span class="p">]</span>
            <span class="p">}]</span>
        <span class="p">},</span>
        <span class="nx">options</span><span class="o">:</span> <span class="p">{</span>
            <span class="nx">responsive</span>: <span class="kt">true</span><span class="p">,</span>
            <span class="nx">maintainAspectRatio</span>: <span class="kt">false</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">chartContainer</span> <span class="o">=</span> <span class="nx">div</span><span class="p">({</span><span class="kd">class</span><span class="o">:</span> <span class="s2">"chartjs-container"</span><span class="p">,</span> <span class="nx">style</span><span class="o">:</span> <span class="s2">"position: relative; height:400px; width:100%"</span><span class="p">})</span>
    <span class="kd">var</span> <span class="nx">chartCanvas</span> <span class="o">=</span> <span class="nx">canvas</span><span class="p">({</span><span class="kd">class</span><span class="o">:</span> <span class="s2">"chartjs"</span><span class="p">})</span>
    <span class="nx">chartContainer</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">chartCanvas</span><span class="p">)</span>
    <span class="kd">var</span> <span class="nx">ctx</span>: <span class="kt">any</span> <span class="o">=</span> <span class="nx">chartCanvas</span><span class="p">.</span><span class="nx">getContext</span><span class="p">(</span><span class="s1">'2d'</span><span class="p">);</span>
    <span class="k">new</span> <span class="p">(</span><span class="nb">window</span> <span class="kr">as</span> <span class="nx">any</span><span class="p">).</span><span class="nx">Chart</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span> <span class="nx">object</span><span class="p">);</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">el</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">chartContainer</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="build-and-test">
<h4>Build and Test<a class="headerlink" href="#build-and-test" title="Permalink to this headline">¶</a></h4>
<p>Run <code class="docutils literal notranslate"><span class="pre">panel</span> <span class="pre">build</span> <span class="pre">panel</span></code> and hard refresh your browser. You should see</p>
<p><img alt="ChartJS Hello World" src="../assets/chartjs-hello-world.png"/></p>
</div>
<div class="section" id="save-your-model">
<h4>Save Your Model<a class="headerlink" href="#save-your-model" title="Permalink to this headline">¶</a></h4>
<p>Remember to stage and/ or commit your working changes.</p>
</div>
</div>
<div class="section" id="next-steps">
<h3>Next Steps<a class="headerlink" href="#next-steps" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Enable setting the Python <code class="docutils literal notranslate"><span class="pre">ChartJS.object</span></code> parameter to any ChartJS dictionary.</p></li>
<li><p>Checkout support for different sizing modes, responsiveness and window maximize.</p></li>
<li><p>Configure the javascript, css, .. dependencies in the Bokeh Python File.</p></li>
<li><p>…..</p></li>
</ul>
</div>
<div class="section" id="check-list">
<h3>Check List<a class="headerlink" href="#check-list" title="Permalink to this headline">¶</a></h3>
<p>When you develop and test your model eventually you should consider implementing and testing</p>
<ul class="simple">
<li><p>Dynamic updates to the <code class="docutils literal notranslate"><span class="pre">object</span></code> parameter and any other parameters added.</p></li>
<li><p>Resizing</p>
<ul>
<li><p>Does it resize when <code class="docutils literal notranslate"><span class="pre">width</span></code> is changed dynamically?</p></li>
<li><p>Does it resize when <code class="docutils literal notranslate"><span class="pre">height</span></code> is changed dynamically?</p></li>
<li><p>Does it work with <code class="docutils literal notranslate"><span class="pre">sizing_mode="stretch_width"</span></code> etc.</p></li>
</ul>
</li>
<li><p>Themes (Light, Dark)</p></li>
<li><p>Window Resizing, Window Maximizing, Window Minimizing.</p></li>
<li><p>Streaming of Data. Is it efficient?</p></li>
<li><p>Events (Click, Hover etc.)</p></li>
<li><p>Consider supporting the Python Wrapper (ECharts -&gt; PyECharts, ChartJS -&gt; <a class="reference external" href="https://pypi.org/project/pyChart.JS/">PyChart.JS</a>)</p></li>
<li><p>Tests</p></li>
<li><p>Reference Notebook</p></li>
<li><p>Communication also to for example ChartJS community and developers.</p></li>
</ul>
</div>
<div class="section" id="tips-and-tricks">
<h3>Tips and Tricks<a class="headerlink" href="#tips-and-tricks" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Work in small increments and stage your changes when they work</p></li>
<li><p>Remember to <code class="docutils literal notranslate"><span class="pre">panel</span> <span class="pre">build</span> <span class="pre">panel</span></code> and hard refresh before you test.</p></li>
<li><p>Add <a class="reference external" href="https://www.w3schools.com/jsref/met_console_log.asp">console.log</a> statements to your <code class="docutils literal notranslate"><span class="pre">.ts</span></code> code for debugging.</p></li>
<li><p>Use the <a class="reference external" href="https://developers.google.com/web/tools/chrome-devtools"><em>Developer Tools</em></a> <em>console</em> to see the <code class="docutils literal notranslate"><span class="pre">console.log</span></code> output and identify errors. In my browsers I toggle the Developer Tools using <code class="docutils literal notranslate"><span class="pre">CTRL+SHIFT+I</span></code>.</p></li>
<li><p>Find inspiration for next steps in the <a class="reference external" href="https://github.com/holoviz/panel/tree/master/panel/models">existing Panel Custom Models</a>. For <code class="docutils literal notranslate"><span class="pre">ChartJS</span></code> one of the most relevant custom models would be <code class="docutils literal notranslate"><span class="pre">Echarts</span></code>. See Panel <a class="reference external" href="https://github.com/holoviz/panel/blob/master/panel/pane/echarts.py">echarts.py</a>, Bokeh <a class="reference external" href="https://github.com/holoviz/panel/blob/master/panel/models/echarts.py">echarts.py</a> and <a class="reference external" href="https://github.com/holoviz/panel/blob/master/panel/models/echarts.ts">echarts.ts</a>.</p></li>
<li><p>Use the existing documentation</p>
<ul>
<li><p><a class="reference external" href="https://panel.holoviz.org/developer_guide/index.html">Panel - Developer Guide</a></p></li>
<li><p><a class="reference external" href="https://docs.bokeh.org/en/latest/docs/user_guide/extensions.html">Bokeh - Extending Bokeh</a></p></li>
<li><p><a class="reference external" href="https://awesome-panel.readthedocs.io/en/latest/guides/awesome-panel-extensions-guide/bokeh-extensions.html">Awesome Panel - Bokeh Extensions Guide</a></p></li>
</ul>
</li>
<li><p>Use Google Search. You don’t have to be an expert javascript or typescript developer. It’s a very small subset of those languages that is used when developing Custom Models.</p></li>
<li><p>Ask for help in <a class="reference external" href="https://gitter.im/pyviz/pyviz">PyViz Gitter</a>, <a class="reference external" href="https://discourse.holoviz.org/">HoloViz Discourse</a> and <a class="reference external" href="https://discourse.bokeh.org/">Bokeh Discourse</a> forums.</p></li>
</ul>
</div>
</div>
<div id="scroller-right">This web page was generated from a Jupyter notebook and not all interactivity will work on this website. <a href="https://raw.githubusercontent.com/holoviz/panel/master/examples/developer_guide/DevelopingCustomModels.ipynb">Right click to download and run locally</a> for full Python-backed interactivity.</div><hr class="docutils"/>
<p><a class="reference external" href="https://raw.githubusercontent.com/holoviz/panel/master/examples/developer_guide/DevelopingCustomModels.ipynb">Right click to download this notebook from GitHub.</a></p>
</div>
</div>
<div class="prev-next-bottom">
</div>
</main>
</div>
</div>
<script src="../_static/js/index.1c5a1a01449ed65a7b51.js"></script>
<footer class="footer mt-5 mt-md-0">
<div class="container">
<div class="footer-item">
<p class="copyright">
    © Copyright 2019-2021 Panel contributors.<br/>
</p>
</div>
<div class="footer-item">
<p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.5.3.<br/>
</p>
</div>
</div>
</footer>
</body>
</html>